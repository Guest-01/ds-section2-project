Section2 Project Script

안녕하십니까 이번 면접의 지원자 장호현입니다.

제가 선정한 데이터는 통신사의 고객 데이터입니다.
해당 데이터를 선정한 이유는 실제 비즈니스에서 수집할만한 데이터셋이기 때문입니다.
해당 데이터에는 직전 분기 고객의 해지 여부가 들어있습니다.
함께 들어있는 다른 특성들을 통해 고객이 해당분기에 해지했는지를 예측할 수 있다면 해당 모델을 통해 추후 해지가 예상되는 고객들을 파악하고 미리 대응할 수 있게 됩니다.

따라서 이 문제는 이진 분류(binary classification)에 해당합니다.

평가지표와 베이스라인에 대해 미리 말씀드리겠습니다.
먼저 타겟인 Churn 컬럼이 불균형하기 때문에 accuracy와 더불어 AUC 스코어를 함께 보도록 하겠습니다.
평가 지표에 대해 설명드리면, accuracy는 단순한 정확도이며 얼마나 많은 샘플의 분류를 맞추었는지를 의미합니다. 따라서 한쪽으로 찍어서 맞추더라도 좋은 점수가 나올 수 있는 한계가 있습니다. AUC 스코어의 경우 서로 다른 두 분류를 얼마나 잘 구별해내었는지를 따져보기 때문에 현재 데이터에 더 적합하다고 볼 수 있습니다.
베이스라인은 타겟의 최빈값 모델로 설정하였습니다.

그럼 EDA와 데이터 전처리부터 시작하겠습니다.

먼저 데이터를 살펴보면 타겟인 Churn을 제외하면 20개의 특성이 존재합니다. 이중 customerID는 고유값이므로 제외하면 tenure, MonthlyCharges, TotalCharges 총 3개의 숫자형 특성과 나머지 16개의 범주형 특성으로 구성되어 있습니다.

데이터에 있는 고객의 분포를 살펴보겠습니다.
성별과 기혼 상태는 고르게 분포하고 있으며 65세 이상을 의미하는 SeniorCitizen은 약 15퍼센트, 그리고 피부양자가 존재하는 경우가 30퍼센트 정도를 구성하고 있습니다.

다음은 계약을 유지한 사람들과 해지한 사람들 사이에 숫자형 특성인 요금과 가입기간이 어떻게 분포하고 있는지 확인해보겠습니다.

여태까지 낸 돈이 적고, 매달 나가는 비용이 높으며, 사용한 기간이 적을수록 해지한 사람들이 많다는 걸 알 수 있습니다.

타겟의 비율도 확인해보겠습니다.
약 73퍼센트가 지난 분기 계약을 유지한 것으로 보입니다.
unbalance한 분포를 가졌기 때문에 앞서 말씀드린대로 AUC 스코어를 평가지표로 활용하도록 하겠습니다.

이제 이 데이터를 여러가지 모델에 적용해보고 교차검증을 통해 평균 점수를 확인해보겠습니다.

교차 검증시에는 누수가 일어나지 않도록 파이프라인을 만들어 그때 그때 fitting을 진행하도록 하겠습니다.

먼저 최빈값으로 찍는 기본 모델입니다.
고객이 해지하지 않는다로만 찍어도 73퍼센트의 정확도를 나타냅니다. 그러나 해지한 경우를 하나도 맞추지 못했기 때문에 AUC 스코어는 최저점인 0.5점이 나왔습니다.

결정 트리 모델과 랜덤 포레스트, 그리고 XGBoost 모델을 차례로 더 적용해보았고, 점수를 보니 랜덤 포레스트 방식이 별다른 튜닝이 없을 때 가장 좋은 스코어를 기록했습니다. 따라서 교차검증을 좀 더 진행하며 하이퍼파라미터를 튜닝해보겠습니다.

튜닝을 통해 평균 AUC 스코어를 0.84까지 개선할 수 있었습니다.
그리고 튜닝이 된 모델을 통해 테스트셋에 적용하여 얻은 최종점수는 아래와 같습니다.

모델이 어떻게 해지를 예측하는지 들여다보도록 하겠습니다.
SHAP value를 통해 어떤 특성이 어떻게 기여하는지를 확인해볼 수 있습니다.

그래프를 보시면 tenure (가입기간)이 가장 높은 기여를 하고 있습니다.

개별 예측 사례에 대해 구체적으로 예시를 살펴보겠습니다.
먼저 해지확률이 0.26으로 가입을 유지할 것으로 예측한 샘플입니다.
빨간색이 해지확률을 높이는데 기여한 특성과 그 값이고, 파란색이 그 반대입니다.
확률 0.7로 해지로 예측한 샘플에 대한 그래프도 확인해볼 수 있습니다.

앞선 EDA로 확인한 것 처럼 가입기간이 매달 내는 비용이 높고, 가입기간이 짧을 수록 해지에 기여하는 바가 큰 것을 확인할 수 있습니다.

